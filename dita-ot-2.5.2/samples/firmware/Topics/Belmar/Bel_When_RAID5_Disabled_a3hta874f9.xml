<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE topic PUBLIC "-//OASIS//DTD DITA 1.2 Topic//EN" "/SysConfig/backup/dtd/technicalContent/dtd/topic.dtd">
<topic xmlns:ditaarch="http://dita.oasis-open.org/architecture/2005/" id="When_RAID5_Disabled_a3hta874f9" base="Princeton" xml:lang="en-US">
   <title>When RAID5 Disabled</title>
   <body>
        

        <section id="Getting_Flash_Addresses_a4hta874f9">
          <title>Getting Flash Addresses</title>

          <ol>
            <li id="d1e9586">
              <p>When a power request with device enable is received,
              Lookup Manager (Lookup Manager0 and Lookup Manager1) sends a
              block open request for all logical targets.</p>
            </li>

            <li id="d1e9592">
              <p>Upon receiving block open completion, mark logical target
              status to IDLE.</p>
            </li>

            <li id="d1e9598">
              <p>Set active logical target to zero.</p>
            </li>
          </ol>
        </section>

        <section id="Processing_Inbound_Write_Requests_a5hta874f9">
          <title>Processing Inbound Write Requests</title>

          <ol>
            <li id="d1e9613">
              <p>Check active logical target status.</p>

              <p>If active logical target is not IDLE or page number is
              equal to max page number of flash block, find next logical
              target that is IDLE. If there are no logical targets in IDLE
              state, add data frame write request to pending list. Pending
              list is processed upon receiving block open completions.</p>
            </li>

            <li id="d1e9622">
              <p>Assign active logical target flash address to the data
              frame.</p>
            </li>

            <li id="d1e9628">
              <p>If it is first data frame of page frame:</p>

              <ul>
                  <li id="d1e9635">
                     <p>Check inbound queue status.</p>
                  </li>

                  <li id="d1e9641">
                     <p>If there are no inbound write requests, enable timer.
                  Refer section 10.3.3 for sequence of operations performed
                  when timer is expired.</p>
                  </li>
              </ul>
            </li>

            <li id="d1e9649">
              <p>If it is second data frame of page frame:</p>

              <ul>
                  <li id="d1e9656">
                     <p>Disable timer if it is active.</p>
                  </li>

                  <li id="d1e9662">
                     <p>Send page frame write request to the Write
                  Managers.</p>
                  </li>

                  <li id="d1e9668">
                     <p>Increment logical target pending completions.</p>
                  </li>

                  <li id="d1e9674">
                     <p>Increment page number.</p>
                  </li>

                  <li id="d1e9680">
                     <p>Set data frame number to zero.</p>
                  </li>

                  <li id="d1e9687">
                     <p>Update active logical target to next logical target if
                  the number of planes is zero. Update the active plane number
                  if there’s more than one plane in the system. Refer to
                  section 10.3.3.3 for multi-plane operation.</p>
                  </li>
              </ul>
            </li>
          </ol>
        </section>

        <section id="Processing_Flash_Completions_a6hta874f9">
          <title>Processing Flash Completions</title>

          <ol>
            <li id="d1e9704">
              <p>Check for flash write errors. If there is no flash write
              error:</p>

              <ul>
                  <li id="d1e9711">
                     <p>Release data frame buffer.</p>
                  </li>

                  <li id="d1e9717">
                     <p>Obsolete old lookup table entry if it is valid.</p>
                  </li>

                  <li id="d1e9723">
                     <p>Update lookup table entry.</p>
                  </li>

                  <li id="d1e9729">
                     <p>Send write completion.</p>
                  </li>
              </ul>
            </li>

            <li id="d1e9737">
              <p>If there is a write error:</p>

              <ul>
                  <li id="d1e9744">
                     <p>Mark logical target has write error.</p>
                  </li>

                  <li id="d1e9750">
                     <p>Set logical target page number to max page number of
                  flash block.</p>
                  </li>

                  <li id="d1e9756">
                     <p>New flash address is assigned to the data frames in
                  failed page frame.</p>
                  </li>
              </ul>
            </li>

            <li id="d1e9764">
              <p>If logical target page number is equal to max page number
              of flash block and logical target pending completions are
              zero:</p>

              <ul>
                  <li id="d1e9771">
                     <p>Set logical target state to waiting for new flash
                  block.</p>
                  </li>

                  <li id="d1e9777">
                     <p>Send block open request to the Wearleveling
                  Manager.</p>
                  </li>
              </ul>
            </li>
          </ol>
        </section>

        <section id="When_Timer_Expired_a7hta874f9">
          <title>When Timer Expired</title>

          <ol>
            <li id="d1e9794">
              <p>Send page frame write request to the Write Manager.</p>
            </li>

            <li id="d1e9800">
              <p>Increment logical target pending completions.</p>
            </li>

            <li id="d1e9806">
              <p>Increment page number.</p>
            </li>

            <li id="d1e9812">
              <p>Set data frame number to zero.</p>
            </li>

            <li id="d1e9818">
              <p>Update active logical target to next logical target if the
              number of planes is zero. Update the active plane number if
              there’s more than one plane in the system. Refer to section
              10.3.3.3 for multi plane operation.</p>
            </li>
          </ol>
        </section>
      </body>
</topic>
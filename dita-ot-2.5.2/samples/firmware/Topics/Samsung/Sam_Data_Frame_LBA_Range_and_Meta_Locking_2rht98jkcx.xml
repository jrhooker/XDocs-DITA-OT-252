<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE topic PUBLIC "-//OASIS//DTD DITA 1.2 Topic//EN" "/SysConfig/backup/dtd/technicalContent/dtd/topic.dtd">
<topic xmlns:ditaarch="http://dita.oasis-open.org/architecture/2005/" base="Princeton" id="Data_Frame_LBA_Range_and_Meta_Locking_2rht98jkcx" xml:lang="en-US">
  <title>Data Frame LBA Range and Meta Locking</title>

  <body>
    <p>The messages described in the following sections are
    utilized by the Locking Manager and managers that wish to obtain a logical
    block address range or meta-page locks.</p>

    <section id="ReadLockReq_2sht98jkcx"><title>ReadLockReq</title> <p>Message
    sent to the Locking Manager to request a read lock for a logical block
    address range.</p> <table id="_2tht98jkcx">
        <title>ReadLockReq</title>

        <tgroup cols="4">
          <colspec colname="c1" colwidth="9*"/>

          <colspec colname="c2" colwidth="11*"/>

          <colspec colname="c3" colwidth="14*"/>

          <colspec colname="c4" colwidth="66*"/>

          <thead>
            <row>
              <entry>DWord</entry>

              <entry>Position</entry>

              <entry>Name</entry>

              <entry>Description</entry>
            </row>
          </thead>

          <struct>
            <dword>
              <value>0</value>

              <position>
                <double>
                  <msb>7</msb>

                  <lsb>0</lsb>
                </double>
              </position>

              <name>opCode</name>

              <description>
                <p>Message Opcode</p>
              </description>
            </dword>

            <dword>
              <value>0</value>

              <position>
                <double>
                  <msb>15</msb>

                  <lsb>8</lsb>
                </double>
              </position>

              <name>outMsgQ</name>

              <description>
                <p>Outbound Message Port ID</p>

                <p>ID of the outbound IPC port that should
                be used when sending the completion to this message.</p>
              </description>
            </dword>

            <dword>
              <value>0</value>

              <position>
                <single>16</single>
              </position>

              <name>queue</name>

              <description>
                <p>Queue Request</p>

                <p>Specifies if the request should be
                queued if the lock cannot be granted.</p>

                <p>0 Requester will be notified via a
                LockCpl message if the lock could not be granted.</p>

                <p>1 Request will be queued if lock is not
                granted.</p>
              </description>
            </dword>

            <dword>
              <value>0</value>

              <position>
                <double>
                  <msb>31</msb>

                  <lsb>17</lsb>
                </double>
              </position>

              <name>reserved</name>

              <description>
                <p>Reserved</p>
              </description>
            </dword>

            <dword>
              <value>1</value>

              <position>
                <double>
                  <msb>31</msb>

                  <lsb>0</lsb>
                </double>
              </position>

              <name>startAddr</name>

              <description>
                <p>Logical Address Range Start</p>

                <p>Start address of logical address range
                to lock.</p>
              </description>
            </dword>

            <dword>
              <value>2</value>

              <position>
                <double>
                  <msb>31</msb>

                  <lsb>0</lsb>
                </double>
              </position>

              <name>endAddr</name>

              <description>
                <p>Logical Address Range End</p>

                <p>End address of logical address range to
                lock. Address ranges are inclusive.</p>
              </description>
            </dword>

            <dword>
              <value>4:3</value>

              <position>
                <double>
                  <msb>31</msb>

                  <lsb>0</lsb>
                </double>
              </position>

              <name>tag</name>

              <description>
                <p>Tag</p>

                <p>Opaque tag information to be returned
                when sending the completion to this message.</p>
              </description>
            </dword>
          </struct>
        </tgroup>
      </table></section>

    <section id="WriteLockReq_2uht98jkcx"><title>WriteLockReq</title> <p>Message
    sent to the Locking Manager to request a write lock for a logical block
    address range.</p> <table id="_2vht98jkcx">
        <title>WriteLockReq</title>

        <tgroup cols="4">
          <colspec colname="c1" colwidth="9*"/>

          <colspec colname="c2" colwidth="11*"/>

          <colspec colname="c3" colwidth="14*"/>

          <colspec colname="c4" colwidth="66*"/>

          <thead>
            <row>
              <entry>DWord</entry>

              <entry>Position</entry>

              <entry>Name</entry>

              <entry>Description</entry>
            </row>
          </thead>

          <struct>
            <dword>
              <value>0</value>

              <position>
                <double>
                  <msb>7</msb>

                  <lsb>0</lsb>
                </double>
              </position>

              <name>opCode</name>

              <description>
                <p>Message Opcode</p>
              </description>
            </dword>

            <dword>
              <value>0</value>

              <position>
                <double>
                  <msb>15</msb>

                  <lsb>8</lsb>
                </double>
              </position>

              <name>outMsgQ</name>

              <description>
                <p>Outbound Message Port ID</p>

                <p>ID of the outbound IPC port that should
                be used when sending the completion to this message.</p>
              </description>
            </dword>

            <dword>
              <value>0</value>

              <position>
                <single>16</single>
              </position>

              <name>queue</name>

              <description>
                <p>Queue Request</p>

                <p>Specifies if the request should be
                queued if the lock can not be granted.</p>

                <p>0 Requester will be notified via a
                LockCpl message if the lock could not be granted.</p>

                <p>1 Request will be queued if lock is not
                granted.</p>
              </description>
            </dword>

            <dword>
              <value>0</value>

              <position>
                <double>
                  <msb>31</msb>

                  <lsb>17</lsb>
                </double>
              </position>

              <name>reserved</name>

              <description>
                <p>Reserved</p>
              </description>
            </dword>

            <dword>
              <value>1</value>

              <position>
                <double>
                  <msb>31</msb>

                  <lsb>0</lsb>
                </double>
              </position>

              <name>startAddr</name>

              <description>
                <p>Logical Address Range Start</p>

                <p>Start address of logical address range
                to lock.</p>
              </description>
            </dword>

            <dword>
              <value>2</value>

              <position>
                <double>
                  <msb>31</msb>

                  <lsb>0</lsb>
                </double>
              </position>

              <name>endAddr</name>

              <description>
                <p>Logical Address Range End</p>

                <p>End address of logical address range to
                lock. Address ranges are inclusive.</p>
              </description>
            </dword>

            <dword>
              <value>4:3</value>

              <position>
                <double>
                  <msb>31</msb>

                  <lsb>0</lsb>
                </double>
              </position>

              <name>tag</name>

              <description>
                <p>Tag</p>

                <p>Opaque tag information to be returned
                when sending the completion to this message.</p>
              </description>
            </dword>
          </struct>
        </tgroup>
      </table></section>

    <section id="MetaLockReq_2wht98jkcx"><title>MetaLockReq</title> <p>Message
    sent to the Locking Manager to request a meta-lock for the specified
    meta-page.</p> <table id="_2xht98jkcx">
        <title>MetaLockReq</title>

        <tgroup cols="4">
          <colspec colname="c1" colwidth="9*"/>

          <colspec colname="c2" colwidth="11*"/>

          <colspec colname="c3" colwidth="14*"/>

          <colspec colname="c4" colwidth="66*"/>

          <thead>
            <row>
              <entry>DWord</entry>

              <entry>Position</entry>

              <entry>Name</entry>

              <entry>Description</entry>
            </row>
          </thead>

          <struct>
            <dword>
              <value>0</value>

              <position>
                <double>
                  <msb>7</msb>

                  <lsb>0</lsb>
                </double>
              </position>

              <name>opCode</name>

              <description>
                <p>Message Opcode</p>
              </description>
            </dword>

            <dword>
              <value>0</value>

              <position>
                <double>
                  <msb>15</msb>

                  <lsb>8</lsb>
                </double>
              </position>

              <name>outMsgQ</name>

              <description>
                <p>Outbound Message Port ID</p>

                <p>ID of the outbound IPC port that should
                be used when sending the completion to this message.</p>
              </description>
            </dword>

            <dword>
              <value>0</value>

              <position>
                <single>16</single>
              </position>

              <name>queue</name>

              <description>
                <p>Queue Request</p>

                <p>Specifies if the request should be
                queued if the lock cannot be granted.</p>

                <p>0 Requester will be notified via a
                LockCpl message if the lock could not be granted.</p>

                <p>1 Request will be queued if lock is not
                granted.</p>
              </description>
            </dword>

            <dword>
              <value>0</value>

              <position>
                <double>
                  <msb>31</msb>

                  <lsb>17</lsb>
                </double>
              </position>

              <name>reserved</name>

              <description>
                <p>Reserved</p>
              </description>
            </dword>

            <dword>
              <value>1</value>

              <position>
                <double>
                  <msb>31</msb>

                  <lsb>0</lsb>
                </double>
              </position>

              <name>metaPage</name>

              <description>
                <p>Meta Page Type</p>

                <p>80000000h Error log page.</p>

                <p>80000001h SMART.</p>

                <p>80000002h Firmware Info.</p>

                <p>80000003h Namespace.</p>

                <p>80000004h NVM Express Features.</p>
              </description>
            </dword>

            <dword>
              <value>2</value>

              <position>
                <double>
                  <msb>31</msb>

                  <lsb>0</lsb>
                </double>
              </position>

              <name>reserved</name>

              <description>
                <p>Reserved</p>
              </description>
            </dword>

            <dword>
              <value>4:3</value>

              <position>
                <double>
                  <msb>31</msb>

                  <lsb>0</lsb>
                </double>
              </position>

              <name>tag</name>

              <description>
                <p>Tag</p>

                <p>Opaque tag information to be returned
                when sending the completion to this message.</p>
              </description>
            </dword>
          </struct>
        </tgroup>
      </table></section>

    <section id="LockCpl_2yht98jkcx"><title>LockCpl</title> <p>Message sent
    from the Locking Manager to inform a requesting manager of the status of a
    previously issued logical block address range or meta-lock request.</p>
    <table id="_2zht98jkcx">
        <title>LockCpl</title>

        <tgroup cols="4">
          <colspec colname="c1" colwidth="9*"/>

          <colspec colname="c2" colwidth="11*"/>

          <colspec colname="c3" colwidth="14*"/>

          <colspec colname="c4" colwidth="66*"/>

          <thead>
            <row>
              <entry>DWord</entry>

              <entry>Position</entry>

              <entry>Name</entry>

              <entry>Description</entry>
            </row>
          </thead>

          <struct>
            <dword>
              <value>0</value>

              <position>
                <double>
                  <msb>7</msb>

                  <lsb>0</lsb>
                </double>
              </position>

              <name>opCode</name>

              <description>
                <p>Message Opcode</p>
              </description>
            </dword>

            <dword>
              <value>0</value>

              <position>
                <double>
                  <msb>15</msb>

                  <lsb>8</lsb>
                </double>
              </position>

              <name>status</name>

              <description>
                <p>Completion Status</p>

                <p>0h The operation completed without
                errors.</p>

                <p>1h A correctable error occurred.</p>

                <p>2h An uncorrectable error occurred.</p>

                <p>3h Lock was not granted due to the meta
                page already being locked or an LBA range lock collision.</p>

                <p>4h Lock was not granted due to a lack of
                available resources.</p>

                <p>All other values are reserved.</p>
              </description>
            </dword>

            <dword>
              <value>0</value>

              <position>
                <double>
                  <msb>31</msb>

                  <lsb>16</lsb>
                </double>
              </position>

              <name>reserved</name>

              <description>
                <p>Reserved</p>
              </description>
            </dword>

            <dword>
              <value>1</value>

              <position>
                <double>
                  <msb>31</msb>

                  <lsb>0</lsb>
                </double>
              </position>

              <name>handle</name>

              <description>
                <p>Lock Handle</p>

                <p>This value is only valid of the status
                field contains 0h.</p>
              </description>
            </dword>

            <dword>
              <value>3:2</value>

              <position>
                <double>
                  <msb>31</msb>

                  <lsb>0</lsb>
                </double>
              </position>

              <name>tag</name>

              <description>
                <p>Tag</p>

                <p>Opaque tag information from the request
                message.</p>
              </description>
            </dword>
          </struct>
        </tgroup>
      </table></section>

    <section id="LockRelease_30ht98jkcx"><title>LockRelease</title> <p>Message
    sent to the Locking Manager to release the lock on a logical block address
    range or meta-page.</p> <table id="_31ht98jkcy">
        <title>LockRelease</title>

        <tgroup cols="4">
          <colspec colname="c1" colwidth="9*"/>

          <colspec colname="c2" colwidth="11*"/>

          <colspec colname="c3" colwidth="14*"/>

          <colspec colname="c4" colwidth="66*"/>

          <thead>
            <row>
              <entry>DWord</entry>

              <entry>Position</entry>

              <entry>Name</entry>

              <entry>Description</entry>
            </row>
          </thead>

          <struct>
            <dword>
              <value>0</value>

              <position>
                <double>
                  <msb>7</msb>

                  <lsb>0</lsb>
                </double>
              </position>

              <name>opCode</name>

              <description>
                <p>Message Opcode</p>
              </description>
            </dword>

            <dword>
              <value>0</value>

              <position>
                <double>
                  <msb>31</msb>

                  <lsb>8</lsb>
                </double>
              </position>

              <name>reserved</name>

              <description>
                <p>Reserved</p>
              </description>
            </dword>

            <dword>
              <value>1</value>

              <position>
                <double>
                  <msb>31</msb>

                  <lsb>0</lsb>
                </double>
              </position>

              <name>handle</name>

              <description>
                <p>Lock Handle</p>

                <p>Handle to the granted lock to be
                released.</p>
              </description>
            </dword>
          </struct>
        </tgroup>
      </table></section>
  </body>
</topic>